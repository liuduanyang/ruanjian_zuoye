<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>car</title>
    <link rel="stylesheet" href="./css/jquery.mobile-1.4.5.min.css">
    <script src="./js/jquery-2.2.2.js"></script>
    <script src="./js/jquery.mobile-1.4.5.min.js"></script>
    <script src="./js/rem.js"></script>
    <style>
        body{
            font-size:0.16rem !important;
        }
        a::after{
            content:none !important;
        }
        .ui-icon-f_1_1{
            background-image:url('./images/f_1_1.png');
        }
        .ui-icon-f_2_1{
            background-image:url('./images/f_2_1.png');
        }
        .ui-icon-f_3_1{
            background-image:url('./images/f_3_1.png');
        }
        .ui-icon-f_4_1{
            background-image:url('./images/f_4_1.png');
            background-size:40% 50%;
            background-position:50% 15%;
            background-repeat:no-repeat;
        }
        .navbar_a{
            background-size:0.414rem 0.28rem;
            background-position:50% 15%;
            background-repeat:no-repeat;
        }
        .content{
            padding-top:0.3rem !important;
        }
        .footer{
            height:0.56rem !important;
        }
        .header_h1{
            background-color:orange;
            color:white;
            margin:0 !important;
            font-weight:200;
        }
        img{
            width:80px;
            height:80px;
        }
        .content p{
            float:right;
            margin-left:10px !important;
        }
    </style>
</head>
<body>
    <div data-role="page">
        <div data-role="header">
            <h1 class="header_h1">购物车</h1>
        </div>
        <div data-role="content" class="content">
            <ul id="list_show" data-role="listview">
                
            </ul>
        </div>
        <div data-role="footer" data-position="fixed" class="footer">
            <div data-role="navbar">
                <ul>
                    <li><a href="./index.html" rel="external" class="navbar_a" data-icon="f_1_1" data-iconpos="top">首页</a></li>
                    <li><a href="more.html" class="navbar_a" data-icon="f_2_1" data-iconpos="top">分类</a></li>
                    <li><a href="#" class="navbar_a" data-icon="f_3_1" data-iconpos="top">购物车</a></li>
                    <li><a href="user.html" data-transition="slide" data-direction="reverse" class="navbar_a" data-icon="f_4_1" data-iconpos="top">我</a></li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        var list_show=document.getElementById("list_show");
        window.onload=function(){
            if(localStorage.getItem('status')=='true'){
                $.ajax({
                    url:'http://datainfo.duapp.com/shopdata/getCar.php',
                    type:'POST',
                    dataType:'JSONP',
                    data:{
                        userID:localStorage.getItem('userID')
                    },
                    success:function(data){
                        if(data){
                            console.log(data);
                            for(var i=0;i<data.length;i++){
                                var li=document.createElement("li");
                                var h1=document.createElement("h1");
                                h1.innerHTML=data[i]['goodsName'];
                                var img=document.createElement("img");
                                img.src=data[i]['goodsListImg'];
                                var p1=document.createElement("p");
                                p1.innerHTML='数量：'+data[i]['number'];
                                var p2=document.createElement("p");
                                p2.innerHTML='价格：'+data[i]['price'];
                                li.setAttribute("goodsID",data[i]['goodsID']);
                                li.appendChild(h1);
                                li.appendChild(img);
                                li.appendChild(p1);
                                li.appendChild(p2);
                                list_show.appendChild(li);
                            }
                            $('li').on('taphold',function(){
                                $.ajax({
                                        url:'http://datainfo.duapp.com/shopdata/updatecar.php',
                                        type:'POST',
                                        dataType:'JSON',
                                        data:{
                                            userID:localStorage.getItem('userID'),
                                            goodsID:this.getAttribute("goodsID"),
                                            number:0
                                        },
                                        success:function(data){
                                            location.href="car.html";
                                        }
                                    });
                                })
                        }
                    }
                })
                }else{
                    alert("请先登录或注册");
                }
        }
    </script>
</body>
</html>